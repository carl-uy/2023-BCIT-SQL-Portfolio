USE Ch08_ConstructCo
GO
DROP TABLE IF EXISTS EMP_1
/*1*/
CREATE TABLE EMP_1(
	EMP_NUM			CHAR(3)	NOT NULL PRIMARY KEY,
	EMP_LNAME		VARCHAR(15) NOT NULL,
	EMP_FNAME		VARCHAR(15) NOT NULL,
	EMP_INITIAL		CHAR(1),
	EMP_HIREDATE	DATE DEFAULT '0000-00-00',
	JOB_CODE	VARCHAR(3)
FOREIGN KEY (JOB_CODE) 
REFERENCES JOB(JOB_CODE)
)
GO
/*2*/
INSERT INTO [Ch08_ConstructCo].[dbo].[EMP_1]
    ([EMP_NUM], [EMP_LNAME], [EMP_FNAME], EMP_INITIAL, EMP_HIREDATE, [JOB_CODE])
VALUES
    (101, 'News', 'John', 'J', '2000-12-08', 502),
    (102, 'Senior', 'David', 'H', '1989-07-12', 501)
GO
INSERT INTO EMP_1 
	SELECT EMP_NUM, EMP_LNAME, EMP_FNAME, EMP_INITIAL, EMP_HIREDATE, JOB_CODE FROM EMPLOYEE 
	WHERE EMP_NUM BETWEEN 103 AND 109;
/*5*/
UPDATE	[Ch08_ConstructCo].[dbo].[EMP_1]
SET		[JOB_CODE] = 501
WHERE	[EMP_NUM] = 107;
GO
/*6*/
DELETE FROM [Ch08_ConstructCo].[DBO].[EMP_1]
WHERE	[EMP_LNAME] = 'Smithfield'
AND		[EMP_FNAME] = 'William'
AND		[EMP_HIREDATE] = '2004-06-22'
AND		[JOB_CODE] = 500;
GO
/*7*/
IF OBJECT_ID('EMP_2', 'U') IS NOT NULL 
BEGIN
    DROP TABLE EMP_2;
END
SELECT * 
INTO EMP_2 
FROM EMP_1;
GO
/*8*/
ALTER TABLE [EMP_2]
ADD	[EMP_PCT] NUMERIC(4,2),
	[PROJ_NUM] CHAR(3);
GO
/*9*/
UPDATE [Ch08_ConstructCo].[dbo].[EMP_2]
SET	[EMP_PCT] = 3.85
WHERE [EMP_NUM] = 103;
GO
/*10*/
UPDATE	[Ch08_ConstructCo].[dbo].[EMP_2]
SET	[EMP_PCT] = 4.00
WHERE [EMP_NUM] IN (101, 105, 107);
GO
/*11*/
UPDATE [Ch08_ConstructCo].[DBO].[EMP_2]
SET	[EMP_PCT] = 10.00
WHERE [EMP_PCT] IS NULL
GO
/*12*/
UPDATE [Ch08_ConstructCo].[dbo].[EMP_2]
SET [EMP_PCT] = [EMP_PCT] + .15
WHERE [EMP_FNAME] = 'Maria' AND [EMP_INITIAL] = 'D' AND [EMP_LNAME] = 'Alonzo';
/*13*/
GO
UPDATE [Ch08_ConstructCo].[dbo].[EMP_2]
SET	[PROJ_NUM] = 18
WHERE [JOB_CODE] = 500;
GO
/*14*/
UPDATE [Ch08_ConstructCo].[dbo].[EMP_2]
SET	[PROJ_NUM] = 25
WHERE [JOB_CODE] >= 5002;
GO
/*15*/
UPDATE [Ch08_ConstructCo].[dbo].[EMP_2]
SET	[PROJ_NUM] = 14
WHERE [EMP_HIREDATE] < '1994-01-01' AND [JOB_CODE] >= 501;
GO
/*16*/
DROP TABLE IF EXISTS CUSTOMER 
CREATE TABLE CUSTOMER(
	CUST_NUM	INT,
	CUST_LNAME	CHAR(30),
	CUST_FNAME	CHAR (30),
	CUST_BALANCE DECIMAL(6,2)
);
GO
/*17*/
DROP TABLE IF EXISTS INVOICE 
CREATE TABLE INVOICE(
	INV_NUM		INT,
	CUST_NUM	INT,
	INV_DATE	DATE DEFAULT '0000-00-00',
	INV_AMOUNT DECIMAL(8,2)
);
GO
/*18*/
INSERT INTO	[Ch08_ConstructCo].[dbo].[CUSTOMER]
	([CUST_NUM],[CUST_LNAME],[CUST_FNAME],[CUST_BALANCE])
VALUES
	(1000, 'Smith', 'Jeanne', 1050.11),
	(1001, 'Ortega', 'Juan', 840.92);
GO
/*19*/
INSERT INTO	[Ch08_ConstructCo].[dbo].[INVOICE]
	([INV_NUM],[CUST_NUM],[INV_DATE],[INV_AMOUNT])
VALUES
	(8000, 1000, '2016-03-23', 235.89),
	(8001, 1001, '2016-03-23', 312.82),
	(8002, 1001, '2016-03-30', 528.10),
	(8003, 1000, '2016-04-12', 194.78),
	(8004, 1000, '2016-04-23', 619.44);
GO
/*23*/
ALTER TABLE [CUSTOMER]
ADD	[CUST_DOB] DATE DEFAULT '0000-00-00';
GO
/*24*/
UPDATE [Ch08_ConstructCo].[dbo].[CUSTOMER]
SET	[CUST_DOB] = '1989-03-15'
WHERE [CUST_NUM] = 1000
GO
/*25*/
UPDATE [Ch08_ConstructCo].[dbo].[CUSTOMER]
SET	[CUST_DOB] = '1988-12-22'
WHERE [CUST_NUM] = 1001
GO
SELECT * FROM [dbo].[ASSIGNMENT] ORDER BY [ASSIGN_NUM];
SELECT * FROM [dbo].[CUSTOMER]   ORDER BY [CUST_NUM];
SELECT * FROM [dbo].[EMP_1]      ORDER BY [EMP_NUM];
SELECT * FROM [dbo].[EMP_2]      ORDER BY [EMP_NUM];
SELECT * FROM [dbo].[EMPLOYEE]   ORDER BY [EMP_NUM];
SELECT * FROM [dbo].[INVOICE]    ORDER BY [INV_NUM];
SELECT * FROM [dbo].[JOB]        ORDER BY [JOB_CODE];
SELECT * FROM [dbo].[PROJECT]    ORDER BY [PROJ_NUM];